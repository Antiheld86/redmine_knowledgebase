
<% articles.each do |article| %>

  <div id="article-<%= article.id %>" class="flex-item box category-<% if article.category.ancestors.first %><%= article.category.ancestors.first.id %><% else %><%= article.category.id %><% end %>" >

      <% style = '' %>
      <% article.attachments.reverse_each do |attach| %>
        <% if attach.thumbnailable? %>
          <% style = 'background-image: url(' + thumbnail_path(attach) + ');' %>
          <% break %>
        <% end %>
      <% end %>

      <div class="tile-thumbnail" style='<%= style %>'>
      </div>

      <%= link_to '', { :controller => 'articles', 
      :action => 'show', 
      :id => article.id, 
      :project_id => @project}, :class => 'flex-link' %>

      <div class="tile-overlay">

      <div class="tile-title"><%= article.title %></div>

      <% unless @author_id %>
        <span class="tile-author">        
	  <%= link_to article.author.name, { :controller => 'articles', 
          :action => 'authored', 
          :author_id => article.author.id, 
          :project_id => @project} %> 
	</span>
      <% end %>

      <div class="tile-rating"><% rating = article.rating_average.to_i %>
	<% for i in 1..rating do %> &#9733; <% end %>
      </div>

      </div>
    </div>
    <% end %>
